/**
 * 点击图例-HYS
 * @param obj
 */
function clickLegend(obj,type){
	$(obj).parent().toggleClass("hover");
	showLayer($(obj).parent().hasClass("hover"),type);
}

/**
 * 显示图层
 * @param type
 */
function showLayer(isShow,type){
	for (i in graphicsNNArr){
		if(graphicsNNArr[i].id==type){
			graphicsNNArr[i].setVisibility(isShow);
			return;
		}
	}
}

function showTips(layerId){
	layer.tips('<a href="#" onclick="openLayerOpacitySet(\''+layerId+'\')">透明度</a>', '#'+layerId+'Li',{
		tips: [2, '#FFF']
	});
}

//地图生成工具栏
//awaterui.toolbar();
//构造图例内容
var mapLegendSet={show:true,toggle:false,items:[
	{id:'ssjk_6',name:'排水泵站',imgSrc:'/awater/waterSystem/ssjk/img/legend_15x15/point_15px_bengz.png',checked:true},
	{id:'ssjk_13',name:'易涝隐患点',imgSrc:'/awater/waterSystem/ssjk/img/legend_15x15/point_15px_jsd.png',checked:true},	
	{id:'ssjk_17',name:'视频点',imgSrc:'/awater/waterSystem/ssjk/img/legend_15x15/point_15px_shex.png',checked:false},
	{id:'ssjk_18',name:'内河站点',imgSrc:'/awater/waterSystem/ssjk/img/legend_15x15/point_15px_nhzd.png',checked:false},
	{id:'ssjk_19',name:'雨量站',imgSrc:'/awater/waterSystem/ssjk/img/legend_15x15/point_15px_yulz.png',checked:false},
	{id:'ssjk_20',name:'水文站',imgSrc:'/awater/waterSystem/ssjk/img/legend_15x15/point_15px_swz.png',checked:false},
	{id:'ssjk_21',name:'井下水位',imgSrc:'/awater/waterSystem/ssjk/img/legend_15x15/point_15px_jxsw.png',checked:true},
	{id:'ssjk_22',name:'仓库',imgSrc:'/awater/waterSystem/ssjk/img/legend_15x15/point_15px_cangk.png',checked:false}]
	,
	ztree:{
		setting:{
			check: {  
                enable: true,  
                nocheckInherit: false  
            },
			data: {
				simpleData: {
					enable: true
				}
			},
			view: {
                showLine: false,
                showIcon: false,
                nameIsHTML: true,
                showTitle: false
            },
            callback: {
				onCheck: legendTreeCheck
			}
		},
		zNodes :[
			{ id:1, pId:0, name:"路面视频", open:false},
			{ id:11, pId:1, layerName:"ssjk_25", name:"<span onmouseover=\"showTips('ssjk_25',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_lmsp.png' />地面视频</span>"},
			{ id:12, pId:1, layerName:"ssjk_26", name:"<span onmouseover=\"showTips('ssjk_26',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_jjsp.png' />交警视频</span>"},
			{ id:2, pId:0, name:"雨量", open:false},
			{ id:21, pId:2, layerName:"ssjk_29", name:"<span onmouseover=\"showTips('ssjk_29',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_yulz.png' />内河站降雨量</span>"},
			{ id:22, pId:2, layerName:"ssjk_30", name:"<span onmouseover=\"showTips('ssjk_30',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_yulz.png' />水文雨量站</span>"},
			{ id:23, pId:2, layerName:"ssjk_31", name:"<span onmouseover=\"showTips('ssjk_31',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_yulz.png' />自建雨量站</span>"},
			{ id:3, pId:0, name:"水位", open:false},
			{ id:31, pId:3, layerName:"ssjk_33", checked:true, name:"<span onmouseover=\"showTips('ssjk_33',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_jxsw.png' />路面(管渠)水位</span>"},
			{ id:32, pId:3, layerName:"ssjk_34", name:"<span onmouseover=\"showTips('ssjk_34',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_nhzd.png' />河道水位</span>"},
			{ id:4, pId:0, name:"流量", open:false},
			{ id:41, pId:4, layerName:"ssjk_35", checked:true, name:"<span onmouseover=\"showTips('ssjk_35',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_gdll.png' />管渠流量</span>"},
			{ id:42, pId:4, layerName:"ssjk_36", name:"<span onmouseover=\"showTips('ssjk_36',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_hdll.png' />河道流量</span>"},
			{ id:5, pId:0, name:"泵站", open:false},
			{ id:51, pId:5, layerName:"ssjk_37", checked:true, name:"<span onmouseover=\"showTips('ssjk_37',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_bengz.png' />泵站水位</span>"},
			{ id:52, pId:5, layerName:"ssjk_27", name:"<span onmouseover=\"showTips('ssjk_27',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_bzsp.png' />排水泵站视频</span>"},
			{ id:53, pId:5, layerName:"ssjk_28", name:"<span onmouseover=\"showTips('ssjk_28',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_nhbzsp.png' />内河泵站视频</span>"},
			{ id:6, pId:0, name:"业务管理点", open:false},
			{ id:61, pId:6, layerName:"ssjk_13", name:"<span onmouseover=\"showTips('ssjk_13',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_jsd.png' />易涝隐患点</span>"},
			{ id:62, pId:6, layerName:"ssjk_22", name:"<span onmouseover=\"showTips('ssjk_22',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_cangk.png' />仓库</span>"},
			{ id:63, pId:6, layerName:"ssjk_23", name:"<span onmouseover=\"showTips('ssjk_23',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_azd.png' />安置点</span>"},
			{ id:63, pId:6, layerName:"ssjk_24", name:"<span onmouseover=\"showTips('ssjk_24',this)\"><img src='/awater/waterSystem/ssjk/img/legend_15x15/point_15px_cld.png' />撤离点</span>"}
		]
	}
}
//地图生成图例
awaterui.mapLegend();

function legendTreeCheck(event, treeId, treeNode){
	if(treeNode.layerName){
		showLayer(treeNode.checked,treeNode.layerName);
	} else {
		//获取子节点，并勾选显示图层
		$(treeNode.children).each(function (index, obj) {
			showLayer(treeNode.checked,obj.layerName);
		});
	}
}